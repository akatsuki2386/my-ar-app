<!DOCTYPE html>
<html>
  <!-- A-FrameとAR.jsのライブラリを読み込む -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

  <body style="margin : 0px; overflow: hidden;">
    <!-- a-sceneがAR空間全体になる -->
    <!-- embedded: Webページに埋め込む形式, arjs: AR.jsの設定 -->
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">

      <!-- 
        マーカーの設定
        type='pattern': カスタムマーカーを使う設定
        url='.../marker.patt': ここに自分で作ったマーカーパターンファイルを指定する
      -->
      <a-marker id="my-marker" type="pattern" url="https://raw.githack.com/AR-js-org/AR.js/master/data/patt.hiro">
        
        <!-- マーカーを認識したら、この中身が表示される -->
        <!-- ここではとりあえず、赤い箱を0.5mの高さに表示 -->
        <a-box id="test-box" position="0 0.5 0" material="color: red;"></a-box>
        
      </a-marker>

      <!-- カメラの設定 -->
      <a-entity camera></a-entity>
    </a-scene>

    <script>
      // JavaScriptでマーカーを検出した時の処理
      window.onload = () => {
        const marker = document.querySelector("#my-marker");

        // マーカーが見つかった時
        marker.addEventListener("markerFound", (e) => {
          console.log("マーカー見つけた！");
          const testBox = document.querySelector("#test-box");
          // 見つけたら箱を緑色に変えてみる
          testBox.setAttribute('material', 'color', 'green');
        });

        // マーカーが見えなくなった時
        marker.addEventListener("markerLost", (e) => {
          console.log("マーカー見失った...");
          const testBox = document.querySelector("#test-box");
          // 見失ったら箱を赤色に戻す
          testBox.setAttribute('material', 'color', 'red');
        });
      };
    </script>
  </body>
</html>
